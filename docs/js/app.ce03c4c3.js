(function(e){function t(t){for(var n,a,o=t[0],l=t[1],c=t[2],d=0,p=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&p.push(i[a][0]),i[a]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],n=!0,o=1;o<s.length;o++){var l=s[o];0!==i[l]&&(n=!1)}n&&(r.splice(t--,1),e=a(a.s=s[0]))}return e}var n={},i={app:0},r=[];function a(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=n,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/discourse_crawler/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0015":function(e,t,s){"use strict";s("e96b")},"56d7":function(e,t,s){"use strict";s.r(t);var n=s("2b0e"),i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("discourse_crawler")],1)},r=[],a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dashboard",attrs:{id:"body"}},[e.showAPI?t("input",{directives:[{name:"model",rawName:"v-model",value:e.apiKEY,expression:"apiKEY"}],attrs:{id:"APIinput",type:"text",placeholder:"Enter OpenAI API Key"},domProps:{value:e.apiKEY},on:{input:function(t){t.target.composing||(e.apiKEY=t.target.value)}}}):e._e(),t("br"),e.showAPI?t("span",[e._v("Set up an OpenAI account and get an API key "),t("a",{attrs:{href:"https://openai.com/product"}},[e._v("here")]),e._v(".")]):e._e(),t("br"),e.showAPI?t("button",{attrs:{id:"apiButton"},on:{click:e.registerAPI}},[e._v("Set API Key")]):e._e(),t("br"),t("br"),t("br"),t("input",{directives:[{name:"model",rawName:"v-model",value:e.urlToScrape,expression:"urlToScrape"}],attrs:{id:"URLInput",type:"input",placeholder:"Enter URL to Crawl"},domProps:{value:e.urlToScrape},on:{input:function(t){t.target.composing||(e.urlToScrape=t.target.value)}}}),t("p"),t("button",{attrs:{id:"startButton"},on:{click:e.grabPage}},[e._v("Crawl Website")]),e.loading?e._e():t("p",{attrs:{id:"loadingContainer"}},[e._v(" Initializing "),t("br"),t("img",{attrs:{id:"loading",src:"/"}}),t("br"),t("span",{attrs:{id:"initialMessage"}},[e._v("(Make sure your webcam is facing you.)")])]),e.showProcess?t("h1",{attrs:{id:"mainTitle"}},[e._v(e._s(e.msg))]):e._e(),e.showProcess?t("p",{attrs:{id:"messageTwo"}},[e._v(" "+e._s(e.msg2)+" ")]):e._e(),e.showProcess?t("p",{attrs:{id:"messageThree"}},[e._v(" "+e._s(e.msg3)+" ")]):e._e(),t("p",{attrs:{id:"terminal"}}),t("section",{staticClass:"visuals",attrs:{id:"visuals"}}),t("section",{attrs:{id:"specificAnalysis"}}),t("section",{attrs:{id:"specificAnalysis2"}}),t("section",{attrs:{id:"specificAnalysis3"}}),t("section",{attrs:{id:"specificAnalysis4"}})])},o=[],l=(s("14d9"),s("5b81"),s("0e14")),c=s("cee4"),u={name:"discourse_crawler",props:{},data(){return{msg:"Discourse Crawler",msg2:"An AI-powered tool for performing top-level analysis of websites.",msg3:"",urlToScrape:"",pageText:"",anger:0,fear:0,surprise:0,disgust:0,sadness:0,happiness:0,readability:0,loading:!0,showProcess:!0,showAPI:!0,anchorsForCrawl:[],secondIteration:!1,JSON1:null,JSON2:null,JSON3:null,JSON4:null,moralFoundationAnalysis:"",apiKEY:"",unique:[]}},created:function(){},methods:{registerAPI:function(){this.showAPI=!1},grabPage:function(){let e=document.createElement("img");e.src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExc3dqdTFidnN6enl2bmZ0b2RndGl0Y29oMWJiOHo0bDc2d3d6YnF3bCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/HN6GLlUsMvue652b2w/giphy.gif",e.setAttribute("id","thinkingIMG"),document.getElementById("terminal").appendChild(e);const t="https://api.allorigins.win/raw?url="+encodeURIComponent(this.urlToScrape)+"&callback=?";c["a"].get(t).then(e=>{const t=e.data,s=t.replace(/\s+/g," ").trim(),n=new DOMParser,i=n.parseFromString(s,"text/html"),r=i;r.querySelectorAll("script, style").forEach(e=>e.remove());let a=r.querySelector("body").innerText.trim();if(0==this.secondIteration){var o=[],l=i.links;const e=i.links.length;for(var c=0;c<l.length;c++){const t=c;i.links[c].href.includes(this.urlToScrape)&&o.push(l[c].href),t===e-1&&(this.pageText=a,this.anchorsForCrawl=o.filter((function(e,t){return o.indexOf(e)==t})),console.log(this.anchorsForCrawl),setTimeout(()=>{console.log("Delayed for 2 seconds."),this.grabSubpages()},2e3))}}}).catch(e=>{console.log(e),this.msg=e})},grabSubpages:function(){let e,t=this.anchorsForCrawl.length;const s=this.anchorsForCrawl.length,n=this.anchorsForCrawl,i=this;for(e=0;e<t;e++)r(e);function r(e){setTimeout((function(){const t=n[e],r=e;var a="https://api.allorigins.win/raw?url="+encodeURIComponent(t)+"&callback=?";c["a"].get(a).then(a=>{const o=a.data,l=o.replace(/\s+/g," ").trim(),c=new DOMParser,u=c.parseFromString(l,"text/html"),d=u;d.querySelectorAll("script, style").forEach(e=>e.remove());let p=d.querySelector("body").innerText.trim();if(console.log("Crawling:"+e+" "+t),i.msg="Crawling",i.msg2=n[e],p.length<=1999){const e=p.substring(100,0),s=e.replace(/"/g," "),n=s.replace(/'/g," ");var h=document.getElementById("specificAnalysis"),g=document.createElement("div");g.innerHTML='{"url":"'+t+'","text":"'+n+'"},',h.appendChild(g)}else{const e=p.substring(100,2e3),s=e.replaceAll('"'," "),n=s.replaceAll("'"," ");var m=document.getElementById("specificAnalysis"),f=document.createElement("div");f.innerHTML='{"url":"'+t+'","text":"'+n+'"},',m.appendChild(f)}r===s-1&&setTimeout(()=>{console.log("Delayed for 2 seconds."),i.getEmotionStats()},2e3)}).catch(e=>{console.log(e),this.msg=e})}),2e3*e)}},getEmotionStats:function(){var e=document.getElementById("specificAnalysis").innerText;const t="["+e.slice(0,-1)+"]",s=JSON.parse(t);let n,i=s.length;const r=s.length,a=this;for(n=0;n<i;n++)o(n);function o(e){setTimeout((function(){console.log("Analyzing Emotion");const t=s[e].url,n=e,i=s[e].text,o=i.substring(i.indexOf("{"));console.log(o);const l=c["a"].create({headers:{Authorization:"Bearer "+a.apiKEY}}),u={model:"text-davinci-003",prompt:'Perform sentiment analysis on the following text, outputting scores between 1 and 10 for anger, fear, happiness, surprise, sadness, and disgust, returning the response in JSON only. Format the as {"anger": number score,"fear": number score,"happiness": number score,"surprise": number score,"sadness": number score,"disgust": number score}. '+o+".",temperature:1,max_tokens:275,top_p:1,frequency_penalty:0,presence_penalty:0};l.post("https://api.openai.com/v1/completions",u).then(e=>{a.msg="Analyzing emotion of",a.msg2=t,console.log(e.data.choices[0].text);const s=JSON.parse(e.data.choices[0].text);a.anger=s.anger,a.fear=s.fear,a.surprise=s.surprise,a.disgust=s.disgust,a.sadness=s.sadness,a.happiness=s.happiness;var n=document.getElementById("specificAnalysis2"),i=document.createElement("div");i.innerHTML='{"url":"'+t+'","text":"'+o+'","anger":'+a.anger+',"fear":'+a.fear+',"surprise":'+a.surprise+',"disgust":'+a.disgust+',"sadness":'+a.sadness+',"happiness":'+a.happiness+"},",n.appendChild(i)}).catch(e=>{console.log(e),a.msg=e}),n===r-1&&setTimeout(()=>{console.log("Delayed for 2 seconds.")},2e3)}),25e3*e)}},getMoralFoundations:function(){var e=document.getElementById("specificAnalysis2").innerText;const t="["+e.slice(0,-1)+"]";if(this.JSON2=JSON.parse(t),null!=this.JSON2){console.log("test");var s,n=this.JSON2.length;const e=this.JSON2.length;for(s=0;s<n;s++){const t=this.JSON2[s].url,n=s,i=this.JSON2[s].anger,r=this.JSON2[s].happiness,a=this.JSON2[s].disgust,o=this.JSON2[s].fear,l=this.JSON2[s].surprise,u=this.JSON2[s].sadness,d=this.JSON2[s].text,p=c["a"].create({headers:{Authorization:"Bearer "+this.apiKEY}}),h={messages:[{role:"user",content:"Analyze this text to identify which of the moral foundations that it represents. Include an explanation."+d}],model:"gpt-4",max_tokens:1e3,temperature:0};p.post("https://api.openai.com/v1/chat/completions",h).then(e=>{this.msg="Analyzing Moral Foundations of:",this.msg2=t,console.log(e.data.choices[0].message.content);const s=e.data.choices[0].message.content.replaceAll('"',"");this.moralFoundationAnalysis=s.replaceAll("'","");var n=document.getElementById("specificAnalysis3"),c=document.createElement("div");c.innerHTML='{"url":"'+t+'","text":"'+d+'","moralFoundation":"'+this.moralFoundationAnalysis+'","anger":'+i+',"fear":'+o+',"surprise":'+l+',"disgust":'+a+',"sadness":'+u+',"happiness":'+r+"},",n.appendChild(c)}).catch(e=>{console.log(e),this.msg=e}),n===e-1&&setTimeout(()=>{console.log("Delayed for 5 seconds."),this.returnJSON()},1e4)}}},returnJSON:function(){var e=document.getElementById("specificAnalysis3").innerText,t="["+e.slice(0,-1)+"]";this.JSON3=t,console.log("JSON2: "+this.JSON3);var s=document.getElementById("specificAnalysis4"),n=document.createElement("div");n.innerHTML=this.JSON3,s.appendChild(n),setTimeout(()=>{console.log("Delayed for 1 second."),this.renderVisuals()},5e3)},renderVisuals:function(){document.getElementById("visuals").style.display="block",document.getElementById("thinkingIMG").remove();let e=document.createElement("img");e.src="https://media.giphy.com/media/QIRDfKwRFXz6nBCQkF/giphy.gif",e.setAttribute("id","thinkingIMG"),document.getElementById("terminal").appendChild(e);var t=document.getElementById("specificAnalysis4").innerText;if(this.JSON4=JSON.parse(t),null!=this.JSON4){console.log("test");var s,n=this.JSON4.length;for(s=0;s<n;s++){const e=this.JSON4[s].url,t=this.JSON4[s].anger,n=this.JSON4[s].happiness,a=this.JSON4[s].disgust,o=this.JSON4[s].fear,l=this.JSON4[s].surprise,c=this.JSON4[s].sadness,u=this.JSON4[s].moralFoundation;var i=document.getElementById("visuals"),r=document.createElement("div");r.innerHTML="<h2>"+e+"</h2><h3>Moral Foundations Analysis: </h3>"+u+"<h3>Emotional Analysis: </h3><ul><li> Anger: "+t+"</li><li> Fear: "+o+"</li><li> Surpise: "+l+"</li><li> Disgust: "+a+"</li><li> Sadness: "+c+"</li><li> Happiness: "+n+"</li></ul>",i.appendChild(r),setTimeout(()=>{console.log("Delayed for 1 second."),document.getElementById("thinkingIMG").remove(),this.msg="Analysis Complete",this.msg2=""},5e3)}}},getReadabilityStats:function(){this.readability=l["gunningFog"](this.workingOutput),console.log(this.readability+" "+this.workingOutput)},reset:function(){location.reload()},unhideData:function(){document.getElementById("rawData").style.display="inline-block"},hideData:function(){document.getElementById("rawData").style.display="none"},renderData:function(){const e=new Promise((e,t)=>{this.getEmotionStats(),this.getReadabilityStats(),e("Data rendered!"),t("Data render failed")});e.then(()=>{this.constructJSON(),this.visualizeData(),this.resetWorkingOutput(),console.log("JSON and charts constructed")})},constructJSON:function(){this.currentDataObject='{"time":"'+this.workingTime+'","wpm":"'+this.wpm+'","content":"'+this.workingOutput+'","Angry":'+this.anger+',"Fear":'+this.fear+',"Excited":'+this.excitement+',"Bored":'+this.boredom+',"Sad":'+this.sadness+',"Happy":'+this.happiness+',"volume":'+this.volumeValue+',"readability":'+this.readability+',"faceAnger":'+this.faceAngry+',"faceDisgust":'+this.faceDisgusted+',"faceFear":'+this.faceFearful+',"faceHappiness":'+this.faceHappy+',"faceNeutral":'+this.faceNeutral+',"faceSadness":'+this.faceSad+',"faceSurprise":'+this.faceSurprised+"},";var e=document.getElementById("rawData");e.innerHTML+=this.currentDataObject,this.overallDataObject=document.getElementById("rawData").innerHTML},pdfResults:function(){window.print()}}},d=u,p=(s("dadd"),s("2877")),h=Object(p["a"])(d,a,o,!1,null,"0e171511",null),g=h.exports,m={name:"App",components:{discourse_crawler:g}},f=m,y=(s("0015"),Object(p["a"])(f,i,r,!1,null,null,null)),v=y.exports;n["a"].config.productionTip=!1,new n["a"]({render:e=>e(v)}).$mount("#app")},af82:function(e,t,s){},dadd:function(e,t,s){"use strict";s("af82")},e96b:function(e,t,s){}});
//# sourceMappingURL=app.ce03c4c3.js.map