(function(e){function t(t){for(var s,i,a=t[0],l=t[1],c=t[2],p=0,d=[];p<a.length;p++)i=a[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,a=1;a<n.length;a++){var l=n[a];0!==r[l]&&(s=!1)}s&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},r={app:0},o=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/discourse_crawler/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0015":function(e,t,n){"use strict";n("e96b")},"56d7":function(e,t,n){"use strict";n.r(t);var s=n("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("discourse_crawler")],1)},o=[],i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dashboard",attrs:{id:"body"}},[e.showProcess3?t("h1",{attrs:{id:"mainTitle"}},[e._v(e._s(e.msg))]):e._e(),e.showProcess2?t("p",{attrs:{id:"messageTwo"}},[e._v(" "+e._s(e.msg2)+" ")]):e._e(),e.showProcess?t("p",{attrs:{id:"messageThree"}},[e._v(" "+e._s(e.msg3)+" ")]):e._e(),e._m(0),e.showProcess2?e._e():t("section",{attrs:{id:"overalExplanation"}},[e._v(" "+e._s(e.overallOutputExplanation)+" "+e._s(e.overallSummaryOutput)+" ")]),e.showAPI?t("input",{directives:[{name:"model",rawName:"v-model",value:e.apiKEY,expression:"apiKEY"}],attrs:{id:"APIinput",type:"text",placeholder:"Enter OpenAI API Key"},domProps:{value:e.apiKEY},on:{input:function(t){t.target.composing||(e.apiKEY=t.target.value)}}}):e._e(),t("br"),e.showAPI?t("span",[e._v("Set up an OpenAI account and get an API key "),t("a",{attrs:{href:"https://openai.com/product"}},[e._v("here")]),e._v(".")]):e._e(),t("br"),e.showAPI?t("button",{attrs:{id:"apiButton"},on:{click:e.registerAPI}},[e._v(" Set API Key ")]):e._e(),t("br"),t("br"),t("br"),e.showProcess?t("input",{directives:[{name:"model",rawName:"v-model",value:e.urlToScrape,expression:"urlToScrape"}],attrs:{id:"URLInput",type:"input",placeholder:"Enter URL to Crawl"},domProps:{value:e.urlToScrape},on:{input:function(t){t.target.composing||(e.urlToScrape=t.target.value)}}}):e._e(),t("p"),e.showProcess?t("button",{attrs:{id:"startButton"},on:{click:e.grabPage}},[e._v(" Crawl Website ")]):e._e(),t("br"),e.showPrint?e._e():t("button",{attrs:{id:"apiButton"},on:{click:e.pdfResults}},[e._v(" Save Results as PDF ")]),t("p",{attrs:{id:"terminal"}}),t("section",{staticClass:"visuals",attrs:{id:"visuals"}}),t("section",{attrs:{id:"specificAnalysis"}}),t("section",{attrs:{id:"specificAnalysis2"}}),t("section",{attrs:{id:"specificAnalysis3"}}),t("section",{attrs:{id:"specificAnalysis4"}}),t("section",{attrs:{id:"specificAnalysis5"}})])},a=[function(){var e=this,t=e._self._c;return t("p",{attrs:{id:"results"}},[t("span",{attrs:{id:"overallMoralFoundations"}}),t("span",{attrs:{id:"overallEmotions"}})])}],l=(n("14d9"),n("5b81"),n("0e14")),c=n("cee4"),u=n("61cc"),p=n.n(u),d={name:"discourse_crawler",props:{},data(){return{msg:"Discourse Crawler",msg2:"An AI-powered tool for performing top-level analysis of websites.",msg3:"",urlToScrape:"",pageText:"",anger:0,fear:0,surprise:0,disgust:0,sadness:0,happiness:0,readability:0,loading:!0,showProcess:!0,showProcess2:!0,showProcess3:!0,showAPI:!0,anchorsForCrawl:[],secondIteration:!1,JSON1:null,JSON2:null,JSON3:null,JSON4:null,moralFoundationAnalysis:"",apiKEY:"",unique:[],overallSummaryOutput:"",overallOutputExplanation:"",showPrint:!0}},created:function(){},methods:{registerAPI:function(){this.showAPI=!1},grabPage:function(){this.showProcess=!1;let e=document.createElement("img");e.src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExc3dqdTFidnN6enl2bmZ0b2RndGl0Y29oMWJiOHo0bDc2d3d6YnF3bCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/HN6GLlUsMvue652b2w/giphy.gif",e.setAttribute("id","thinkingIMG"),document.getElementById("terminal").appendChild(e);const t="https://api.allorigins.win/raw?url="+encodeURIComponent(this.urlToScrape)+"&callback=?";c["a"].get(t).then(e=>{const t=e.data,n=t.replace(/\s+/g," ").trim(),s=new DOMParser,r=s.parseFromString(n,"text/html"),o=r;o.querySelectorAll("script, style").forEach(e=>e.remove());let i=o.querySelector("body").innerText.trim();if(0==this.secondIteration){var a=[],l=r.links;const e=r.links.length;for(var c=0;c<l.length;c++){const t=c;r.links[c].href.includes(this.urlToScrape)&&a.push(l[c].href),t===e-1&&(this.pageText=i,this.anchorsForCrawl=a.filter((function(e,t){return a.indexOf(e)==t})),console.log(this.anchorsForCrawl),setTimeout(()=>{console.log("Delayed for 2 seconds."),this.grabSubpages()},2e3))}}}).catch(e=>{console.log(e),this.msg=e})},grabSubpages:function(){let e,t=this.anchorsForCrawl.length;const n=this.anchorsForCrawl.length,s=this.anchorsForCrawl,r=this;for(e=0;e<t;e++)o(e);function o(e){setTimeout((function(){const t=s[e],o=e;var i="https://api.allorigins.win/raw?url="+encodeURIComponent(t)+"&callback=?";c["a"].get(i).then(i=>{const a=i.data,l=a.replace(/\s+/g," ").trim(),c=new DOMParser,u=c.parseFromString(l,"text/html"),p=u;p.querySelectorAll("script, style").forEach(e=>e.remove());let d=p.querySelector("body").innerText.trim();if(console.log("Crawling:"+e+" "+t),r.msg="Crawling",r.msg2=s[e],d.length<=1999){const e=d.substring(100,0),n=e.replace(/"/g," "),s=n.replace(/'/g," ");var h=document.getElementById("specificAnalysis"),m=document.createElement("div");m.innerHTML='{"url":"'+t+'","text":"'+s+'"},',h.appendChild(m)}else{const e=d.substring(100,2e3),n=e.replaceAll('"'," "),s=n.replaceAll("'"," ");var g=document.getElementById("specificAnalysis"),f=document.createElement("div");f.innerHTML='{"url":"'+t+'","text":"'+s+'"},',g.appendChild(f)}o===n-1&&setTimeout(()=>{console.log("Delayed for 2 seconds."),r.getEmotionStats()},2e3)}).catch(e=>{console.log(e),this.msg=e})}),2e3*e)}},getEmotionStats:function(){var e=document.getElementById("specificAnalysis").innerText;const t="["+e.slice(0,-1)+"]",n=JSON.parse(t);let s,r=n.length;const o=n.length,i=this;for(s=0;s<r;s++)a(s);function a(e){setTimeout((function(){console.log("Analyzing Emotion");const t=n[e].url,s=e,r=n[e].text,a=c["a"].create({headers:{Authorization:"Bearer "+i.apiKEY}}),l={model:"gpt-3.5-turbo-instruct",prompt:'Perform sentiment analysis on the following text, outputting scores between 1 and 10 for anger, fear, happiness, surprise, sadness, and disgust, returning the response in JSON only. Format as {"anger": number score,"fear": number score,"happiness": number score,"surprise": number score,"sadness": number score,"disgust": number score}. '+r+".",temperature:0,max_tokens:256,top_p:1,frequency_penalty:0,presence_penalty:0};a.post("https://api.openai.com/v1/completions",l).then(n=>{i.msg="Analyzing emotion of",i.msg2=t;const s=n.data.choices[0].text,o=s.substring(s.indexOf("{")),a="subPage";console.log(e+": "+o);const l=JSON.parse(o);i.anger=l.anger,i.fear=l.fear,i.surprise=l.surprise,i.disgust=l.disgust,i.sadness=l.sadness,i.happiness=l.happiness;var c=document.getElementById("specificAnalysis2"),u=document.createElement("div");u.innerHTML='{"pageType":"'+a+'","url":"'+t+'","text":"'+r+'","anger":'+i.anger+',"fear":'+i.fear+',"surprise":'+i.surprise+',"disgust":'+i.disgust+',"sadness":'+i.sadness+',"happiness":'+i.happiness+"},",c.appendChild(u)}).catch(e=>{console.log(e),i.msg=e}),s===o-1&&setTimeout(()=>{console.log("Delayed for 2 seconds."),i.getMoralFoundations()},2e3)}),500*e)}},getMoralFoundations:function(){var e=document.getElementById("specificAnalysis2").innerText;const t="["+e.slice(0,-1)+"]",n=JSON.parse(t);let s,r=n.length;const o=n.length,i=this;for(s=0;s<r;s++)a(s);function a(e){setTimeout((function(){console.log("Analyzing moral foundations");const t=n[e].url,s=e,r=n[e].anger,a=n[e].happiness,l=n[e].disgust,u=n[e].fear,p=n[e].surprise,d=n[e].sadness,h=n[e].text,m="subPage",g=c["a"].create({headers:{Authorization:"Bearer "+i.apiKEY}}),f={model:"gpt-3.5-turbo-instruct",prompt:"Analyze this text to identify which of these five moral foundations that it best represents: care, fairness, loyalty, authority, and purity. Include an explanation. Text:"+h+".",temperature:0,max_tokens:275,top_p:1,frequency_penalty:0,presence_penalty:0};g.post("https://api.openai.com/v1/completions",f).then(e=>{i.msg="Analyzing moral foundations of",i.msg2=t,console.log(e.data.choices[0].text);const n=e.data.choices[0].text.replaceAll('"',"");i.moralFoundationAnalysis=n.replaceAll("'","");var s=document.getElementById("specificAnalysis3"),o=document.createElement("div");o.innerHTML='{"pageType":"'+m+'","url":"'+t+'","text":"'+h+'","moralFoundation":"'+i.moralFoundationAnalysis+'","anger":'+r+',"fear":'+u+',"surprise":'+p+',"disgust":'+l+',"sadness":'+d+',"happiness":'+a+"},",s.appendChild(o)}).catch(e=>{console.log(e),this.msg=e}),s===o-1&&setTimeout(()=>{console.log("Delayed for 5 seconds."),i.returnJSON()},2e3)}),500*e)}},returnJSON:function(){var e=document.getElementById("specificAnalysis3").innerText,t="["+e.slice(0,-1)+"]";this.JSON3=t,console.log("JSON2: "+this.JSON3);var n=document.getElementById("specificAnalysis4"),s=document.createElement("div");s.innerHTML=this.JSON3,n.appendChild(s),setTimeout(()=>{console.log("Delayed for 1 second."),this.renderVisuals()},2e3)},renderVisuals:function(){document.getElementById("visuals").style.display="block",document.getElementById("thinkingIMG").remove();let e=document.createElement("img");e.src="https://media.giphy.com/media/QIRDfKwRFXz6nBCQkF/giphy.gif",e.setAttribute("id","thinkingIMG2"),document.getElementById("terminal").appendChild(e);var t=document.getElementById("specificAnalysis4").innerText;if(this.JSON4=JSON.parse(t),null!=this.JSON4){console.log("test");var n,s=this.JSON4.length;for(n=0;n<s;n++){const e=this.JSON4[n].url,t=this.JSON4[n].anger,i=this.JSON4[n].happiness,a=this.JSON4[n].disgust,l=this.JSON4[n].fear,c=this.JSON4[n].surprise,u=this.JSON4[n].sadness,p=this.JSON4[n].moralFoundation;var r=document.getElementById("visuals"),o=document.createElement("div");o.innerHTML="<h2>"+e+"</h2><h3>Moral Foundations Analysis: </h3>"+p+"<h3>Emotional Analysis: </h3><ul><li> Anger: "+t+"</li><li> Fear: "+l+"</li><li> Surprise: "+c+"</li><li> Disgust: "+a+"</li><li> Sadness: "+u+"</li><li> Happiness: "+i+"</li></ul>",r.appendChild(o),n===s-1&&setTimeout(()=>{console.log("Delayed for 4 seconds."),document.getElementById("thinkingIMG2").remove(),this.msg="Analysis Complete",this.msg2="",this.getOverallMoralFoundationScores()},4e3)}}},getOverallMoralFoundationScores:function(){this.showProcess2=!1,this.msg=this.urlToScrape;var e=document.getElementById("specificAnalysis4").innerText;const t=JSON.parse(e),n=this,s="overallMoral";let r="";const o=t.length;for(var i=0;i<o;i++)if(r=r+=t[i].moralFoundation.substring(0,70)+".",i===o-1){n.overallSummaryOutput=r;const e=c["a"].create({headers:{Authorization:"Bearer "+n.apiKEY}}),t={model:"gpt-3.5-turbo-instruct",prompt:'Give me scores between 1 and 100 that indicate the mentions of care, fairness, loyalty, authority, and purity in the following text formatted in JSON as {"care": number score,"fairness": number score,"loyalty": number score,"authority": number score,"purity": number score}. Explain those scores. Text:'+n.overallSummaryOutput+".",temperature:0,max_tokens:850,top_p:1,frequency_penalty:0,presence_penalty:0};e.post("https://api.openai.com/v1/completions",t).then(e=>{n.msg=n.urlToScrape;const t=e.data.choices[0].text;console.log(t);const r=t.substring(t.indexOf("}")+1),o=t.substring(0,t.indexOf("}")+1);console.log(r+" : "+o);const i=JSON.parse(o),a=i.care,l=i.fairness,c=i.loyalty,u=i.authority,d=i.purity;n.overallOutputExplanation=r;var h=document.getElementById("specificAnalysis3"),m=document.createElement("div");m.innerHTML='{"pageType":"'+s+'","url":"'+n.urlToScrape+'","overallCare":'+a+',"overallFairness":'+l+',"overallLoyalty":'+c+',"overallAuthority":'+u+',"overallPurity":'+d+',"moralFoundationOverall":"'+r+'"},',h.appendChild(m);var g=[{x:["Care","Fairness","Loyalty","Authority","Purity"],y:[a,l,c,u,d],type:"bar",marker:{color:["#bf4e30","#c6ccb2","#93ff96","#e5eafa","#78fecf"]}}],f={height:450,width:450,showlegend:!1,paper_bgcolor:"#2b2d42",plot_bgcolor:"#2b2d42",title:"Moral Foundations",font:{family:"Arial, monospace",size:25,color:"white"},margin:{l:50,r:50,b:100,t:100,pad:4}},y={responsive:!0};p.a.newPlot("overallMoralFoundations",g,f,y),setTimeout(()=>{console.log("Delayed for 1 second."),this.renderOverallEmotion()},1e3)}).catch(e=>{console.log(e),this.msg=e})}},renderOverallEmotion:function(){var e=document.getElementById("specificAnalysis4").innerText;const t=JSON.parse(e);let n=0,s=0,r=0,o=0,i=0,a=0;console.log(t.length);const l=this,c=t.length;for(var u=0;u<c;u++)if(n+=t[u].anger,s+=t[u].fear,r+=t[u].happiness,o+=t[u].surprise,i+=t[u].sadness,a+=t[u].disgust,u===c-1){n=10*Math.round(n/c),s=10*Math.round(s/c),r=10*Math.round(r/c),o=10*Math.round(o/c),i=10*Math.round(i/c),a=10*Math.round(a/c);var d=[{type:"pie",values:[n,s,r,o,i,a],labels:["Anger","Fear","Happiness","Surprise","Sadness","Disgust"],textinfo:"label+percent",textposition:"outside",marker:{colors:["#ff0022","#ffbc42","#0496ff","#694d75","#1b5299","#40434e"]}}],h={height:450,width:450,showlegend:!1,paper_bgcolor:"#2b2d42",title:"Emotions",font:{family:"Arial, monospace",size:25,color:"white"},margin:{l:50,r:50,b:100,t:100,pad:4}},m={responsive:!0};p.a.newPlot("overallEmotions",d,h,m),setTimeout(()=>{console.log("Delayed for 1 second."),l.returnJSONAgain()},1e3)}},returnJSONAgain:function(){var e=document.getElementById("specificAnalysis3").innerText,t="["+e.slice(0,-1)+"]";const n=t;console.log("JSON2: "+n);var s=document.getElementById("specificAnalysis5"),r=document.createElement("div");r.innerHTML=n,s.appendChild(r),this.showPrint=!1},getReadabilityStats:function(){this.readability=l["gunningFog"](this.workingOutput),console.log(this.readability+" "+this.workingOutput)},reset:function(){location.reload()},unhideData:function(){document.getElementById("rawData").style.display="inline-block"},hideData:function(){document.getElementById("rawData").style.display="none"},renderData:function(){const e=new Promise((e,t)=>{this.getEmotionStats(),this.getReadabilityStats(),e("Data rendered!"),t("Data render failed")});e.then(()=>{this.constructJSON(),this.visualizeData(),this.resetWorkingOutput(),console.log("JSON and charts constructed")})},constructJSON:function(){this.currentDataObject='{"time":"'+this.workingTime+'","wpm":"'+this.wpm+'","content":"'+this.workingOutput+'","Angry":'+this.anger+',"Fear":'+this.fear+',"Excited":'+this.excitement+',"Bored":'+this.boredom+',"Sad":'+this.sadness+',"Happy":'+this.happiness+',"volume":'+this.volumeValue+',"readability":'+this.readability+',"faceAnger":'+this.faceAngry+',"faceDisgust":'+this.faceDisgusted+',"faceFear":'+this.faceFearful+',"faceHappiness":'+this.faceHappy+',"faceNeutral":'+this.faceNeutral+',"faceSadness":'+this.faceSad+',"faceSurprise":'+this.faceSurprised+"},";var e=document.getElementById("rawData");e.innerHTML+=this.currentDataObject,this.overallDataObject=document.getElementById("rawData").innerHTML},pdfResults:function(){window.print()}}},h=d,m=(n("9637"),n("2877")),g=Object(m["a"])(h,i,a,!1,null,"78e0317e",null),f=g.exports,y={name:"App",components:{discourse_crawler:f}},v=y,b=(n("0015"),Object(m["a"])(v,r,o,!1,null,null,null)),w=b.exports;s["a"].config.productionTip=!1,new s["a"]({render:e=>e(w)}).$mount("#app")},"86da":function(e,t,n){},9637:function(e,t,n){"use strict";n("86da")},e96b:function(e,t,n){}});
//# sourceMappingURL=app.eaf29300.js.map